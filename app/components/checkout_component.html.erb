<div class="flex justify-between">
  <h3 class="text-3xl font-bold"><%= t(".checkout") %></h3>
  <div class="bg-gray-100 p-4 rounded-md text-right">
    <div class="text-lg font-semibold"><%= account.name %></div>
    <div class="text-xs italic"><%= t(".acc_number", acc_number: account.number) %></div>
  </div>
</div>
<div class="mt-10 flex">
  <div class="w-5/12">
    <%= property_image_with_details %>
  </div>

  <div class="w-7/12 border border-gray-200 p-8 relative">
    <h3 class="text-xl font-bold"><%= t(".review_checkout") %></h3>
    <p class="mt-4">
      <%= t(".review_message_html", acc_name: account.name, units: property.number_of_units, unit_price: price_per_unit, name: property.name) %>
    </p>

    <div
      class="absolute bottom-8 inset-x-8"
      data-controller="page-reload paypal-client"
      data-page-reload-url-value="<%= refresh_path %>"
      data-paypal-client-trxn-amount-value="<%= property.transaction_grand_total %>"
      data-paypal-client-paypal-id-value="<%= paypal_client_id %>"
      data-paypal-client-braintree-authorization-value="<%= braintree_client_authorization %>"
      data-paypal-client-braintree-prefix-value="<%= braintree_nonce_prefix %>"
    >
      <%= form_with model: property, scope: property.scope, url: { action: 'create', controller: :checkout },data: {page_reload_target: :form, paypal_client_target: :form} do |f|%>
        <h4 class="text-lg font-semibold text-gray-500"><%= t(".transaction_summary") %></h4>
        <div>
          <ul class="flex mt-2 divide-x divide-gray-300">
            <li class="bg-gray-200 p-4 w-1/3">
              <div class="text-xs"><%= t(".units_to_acquire") %></div>
              <%= f.number_field :number_of_units,
                step: 1,
                value: property.number_of_units,
                min: property.number_of_units,
                oninput: prevent_decimal_value,
                class: "form-input",
                autofocus: true,
                data: { action: "change->page-reload#refreshWithParams" }
              %>
            </li>
            <li class="bg-gray-200 p-4 w-1/3">
              <div class="text-xs"><%= t(".subtotal") %></div>
              <div class="text-xl"><%= transaction_subtotal %></div>
            </li>
            <li class="bg-gray-200 p-4 w-1/3">
              <div class="text-xs"><%= t(".transaction_fee") %></div>
              <div class="text-xl"><%= transaction_fee %></div>
            </li>
            <li class="bg-gray-200 p-4 w-1/3">
              <div class="text-xs"><%= t(".grand_total") %></div>
              <div class="text-3xl font-semibold"><%= transaction_grand_total %></div>
            </li>
          </ul>
          <div class="text-right mt-4 relative">
            <div id="paypal-button" class="absolute b-0 inset-x-0 opacity-0"></div>
            <%= render Ui::PrimaryButtonComponent.new(
              title: t(".pay_with_paypal"),
              rounded: true,
              full_width: true
            ) %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>
